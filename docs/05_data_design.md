# 05_DATA_DESIGN（数据设计）

> 本文档用于定义系统中**需要被长期保存的数据结构与关系**。
>
> 设计目标不是数据库最优解，而是：
> - 最大程度保留用户的真实体验
> - 最小化记录与维护成本
> - 为未来扩展留出空间但不制造负担

---

## 一、数据设计总体原则

1. **数据是“记忆的容器”，不是约束人的工具**
2. **所有核心对象都允许“不完整”存在**
3. **关系优于字段，语义优于范式**
4. **宁可字段少，也不要强制填写**

---

## 二、核心数据实体（概念级 Schema）

> 本节为“概念数据结构”，不等同于最终数据库表。

---

### 1️⃣ Item（物品）

**用途**：
- 标识一个可被反复提及、回溯的具体事物

**核心字段（概念）**：
- id（唯一标识）
- name（主名称）
- alias（别名，可选）
- category（分类，可选）
- status（在用 / 闲置 / 已消耗 / 已丢弃）
- created_at
- updated_at

**设计说明**：
- name 是唯一必填字段
- 其他字段允许长期为空

---

### 2️⃣ Location（位置）

**用途**：
- 描述用户理解中的“放置位置”

**核心字段**：
- id
- name（如“衣柜左下角”）
- parent_id（用于层级）
- created_at

**设计说明**：
- 不要求完整路径
- 层级是逻辑概念，不追求物理准确

---

### 3️⃣ Experience（体验）

**用途**：
- 承载一次具体经历，是 Feeling 的主要宿主

**核心字段**：
- id
- title（可选，如“一次失败的奶茶尝试”）
- item_id（可选）
- event_id（可选）
- occurred_at（发生时间）
- note（简述，可选）
- created_at

**设计说明**：
- item_id 与 event_id 至少存在一个
- title 与 note 均可为空

---

### 4️⃣ Feeling（感受）

**用途**：
- 保存用户主观、模糊、不稳定的情绪或判断

**核心字段**：
- id
- experience_id（可选）
- event_id（可选）
- content（自由文本）
- created_at

**设计说明**：
- 不做情绪类型字段
- content 是唯一必填字段

---

### 5️⃣ Event（事件）

**用途**：
- 记录对用户产生影响的一次事情

**核心字段**：
- id
- title（简述）
- occurred_at
- note（可选）
- created_at

**设计说明**：
- Event 可以独立存在
- 不要求关联 Item

---

### 6️⃣ Tag（标签）

**用途**：
- 建立跨对象的轻量连接

**核心字段**：
- id
- name
- created_at

---

## 三、关系设计（逻辑层）

### 1. Item ↔ Location
- 一个 Item 在不同时间可对应不同 Location
- 实现层可使用中间表或历史记录

### 2. Experience ↔ Item / Event
- Experience 至少关联一个 Item 或 Event
- 不强制唯一

### 3. Feeling ↔ Experience / Event
- Feeling 必须依附存在
- 不允许“孤立 Feeling”

### 4. Tag ↔ All
- Tag 可关联 Item / Experience / Event / Feeling
- 多对多关系

---

## 四、允许的数据“不完美状态”

系统必须允许以下情况长期存在：

- 没有分类的 Item
- 没有关联 Location 的 Item
- 没有 Feeling 的 Experience
- 没有 Experience 的 Item
- 只有一句话的 Feeling

这些都不是异常，而是**系统的常态输入**。

---

## 五、刻意不设计的数据

当前阶段明确不设计：

- 用户表
- 权限系统
- 情绪强度 / 分值
- 自动生成字段（总结、结论）

---

## 六、设计底线声明

当未来出现以下冲突时：

- 数据结构完整性  vs  真实记录成本
- 数据规范  vs  用户的当下状态

**一律选择后者。**

> 这个系统存在的前提是：
> 用户愿意继续用它。

